webpackJsonp([19],{"8eDG":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=i("mvHQ"),r=i.n(a),n=i("XxU+"),o={name:"columnAdd",components:{ImageUpload:i("TAej").a},data:function(){return{loading:!1,dialogStatus:"",dialogFormVisible:!1,textMap:{update:"编辑",create:"添加"},form:{name:"",priority:1,authority:"",skipType:1,skipUrl:"",parentId:0,id:void 0,thumbnail:""},rules:{name:[{required:!0,message:"请输入栏目名称",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符",trigger:"blur"}],priority:[{required:!0,message:"请输入排列顺序",trigger:"blur"}],authority:[{required:!0,message:"请选择浏览权限",trigger:"change"}],thumbnail:[{required:!0,message:"请上传缩略图",trigger:"blur"}],skipUrl:[{required:!0,message:"请输入外部链接",trigger:"blur"}],skipType:[{required:!0,message:"请选择跳转地址",trigger:"change"}]}}},methods:{create:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.loading=!0,e.form.id=void 0,Object(n.a)(e.form).then(function(){e.dialogFormVisible=!1,e.$notify({title:"成功",message:"创建成功",type:"success",duration:2e3}),e.success()}).catch(function(){e.loading=!1})})},update:function(t){var e=this;this.$refs[t].validate(function(t){if(!t)return!1;e.loading=!0,Object(n.e)(e.form).then(function(){e.dialogFormVisible=!1,e.$notify({title:"成功",message:"编辑成功",type:"success",duration:2e3}),e.success()}).catch(function(){e.loading=!1})})},resetForm:function(t,e){var i=this;this.$nextTick(function(){i.$refs[t].resetFields(),i.form.skipUrl="",i.form.id=void 0,setTimeout(function(){e&&e()})})},cancel:function(){this.dialogFormVisible=!1,this.resetForm("form")},success:function(){this.loading=!1,this.$emit("success",JSON.parse(r()(this.form)))},uploadSuccess:function(t){this.form.thumbnail=t[t.length-1].key},checkFile:function(t,e){}}},l={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("el-dialog",{attrs:{title:t.textMap[t.dialogStatus],visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e}}},[i("el-form",{ref:"form",staticClass:"ruleForm",staticStyle:{width:"50%"},attrs:{model:t.form,rules:t.rules,"label-width":"100px"}},[i("el-form-item",{attrs:{label:"栏目名称",prop:"name"}},[i("el-input",{model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"缩略图",prop:"thumbnail"}},[t.form.thumbnail?i("el-card",{staticStyle:{width:"250px"},attrs:{"body-style":{padding:"0px"}}},[i("img",{staticClass:"image",attrs:{src:t._f("setImg")(t.form.thumbnail)}}),t._v(" "),i("div",{staticStyle:{padding:"14px"}},[i("div",{staticClass:"bottom clearfix"},[i("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(e){t.form.thumbnail=""}}},[t._v("删除")])],1)])]):t._e(),t._v(" "),i("ImageUpload",{directives:[{name:"show",rawName:"v-show",value:!t.form.thumbnail,expression:"!form.thumbnail"}],attrs:{multiple:!1,checkFile:t.checkFile,prefix:"news"},on:{successCBK:t.uploadSuccess}})],1),t._v(" "),i("el-form-item",{attrs:{label:"排列顺序",prop:"priority"}},[i("el-input",{attrs:{type:"number",maxlength:"2"},model:{value:t.form.priority,callback:function(e){t.$set(t.form,"priority",t._n(e))},expression:"form.priority"}})],1),t._v(" "),i("el-form-item",{attrs:{label:"浏览权限",prop:"authority"}},[i("el-select",{attrs:{placeholder:"请选择浏览权限"},model:{value:t.form.authority,callback:function(e){t.$set(t.form,"authority",e)},expression:"form.authority"}},[i("el-option",{attrs:{label:"开放浏览",value:1}}),t._v(" "),i("el-option",{attrs:{label:"注册会员",value:2}}),t._v(" "),i("el-option",{attrs:{label:"中级会员",value:3}}),t._v(" "),i("el-option",{attrs:{label:"高级会员",value:4}}),t._v(" "),i("el-option",{attrs:{label:"钻石会员",value:5}})],1)],1),t._v(" "),i("el-form-item",{attrs:{label:"跳转地址",prop:"skipType"}},[i("el-radio-group",{model:{value:t.form.skipType,callback:function(e){t.$set(t.form,"skipType",t._n(e))},expression:"form.skipType"}},[i("el-radio",{attrs:{label:1}},[t._v("栏目列表")]),t._v(" "),i("el-radio",{attrs:{label:2}},[t._v("外部链接")])],1)],1),t._v(" "),2===t.form.skipType?i("el-form-item",{attrs:{label:"填写链接",prop:"skipUrl"}},[i("el-input",{model:{value:t.form.skipUrl,callback:function(e){t.$set(t.form,"skipUrl",e)},expression:"form.skipUrl"}})],1):t._e(),t._v(" "),i("el-form-item",[i("el-button",{on:{click:function(e){t.cancel("form")}}},[t._v("取 消")]),t._v(" "),"create"==t.dialogStatus?i("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){t.create("form")}}},[t._v("确 定")]):i("el-button",{attrs:{type:"primary",loading:t.loading},on:{click:function(e){t.update("form")}}},[t._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var s=i("VU/8")(o,l,!1,function(t){i("k1Y/")},"data-v-8869537e",null).exports,c=i("s3ol"),u={name:"column",directives:{waves:i("cAgV").a},data:function(){return{columns:[{text:"栏目名称",value:"name"}],data:[],listQuery:{name:void 0}}},created:function(){this.getList()},methods:{getList:function(){var t=this;Object(n.d)(this.listQuery).then(function(e){t.data=e.data})},handlerDelete:function(t){var e=this;this.$confirm("确定删除当前栏目（包含子栏目数据）？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){Object(n.b)(t.id).then(function(){e.$notify({title:"成功",message:"删除成功",type:"success",duration:2e3}),e.getList()})})},handlerAdd:function(t){var e=this.$refs.dialog;e.dialogStatus="create",e.dialogFormVisible=!0,e.resetForm("form",function(){e.form.parentId=t&&t.id?t.id:0})},handleUpdate:function(t){var e=this;Object(n.c)(t.id).then(function(t){var i=e.$refs.dialog;i.dialogStatus="update",i.dialogFormVisible=!0,i.resetForm("form",function(){i.form=t.data})})},success:function(t){this.getList()}},components:{Add:s,TreeTable:c.a}},m={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"app-container"},[i("div",{staticClass:"filter-container"},[i("el-input",{staticClass:"filter-item",staticStyle:{width:"200px"},attrs:{placeholder:"输入栏目名称进行过滤"},nativeOn:{keyup:function(e){if(!("button"in e)&&t._k(e.keyCode,"enter",13,e.key))return null;t.getList(e)}},model:{value:t.listQuery.name,callback:function(e){t.$set(t.listQuery,"name",e)},expression:"listQuery.name"}}),t._v(" "),i("el-button",{directives:[{name:"waves",rawName:"v-waves"}],staticClass:"filter-item",attrs:{type:"primary",icon:"el-icon-search"},on:{click:t.getList}},[t._v("搜索")]),t._v(" "),i("el-button",{staticClass:"filter-item",staticStyle:{"margin-left":"10px"},attrs:{type:"primary",icon:"plus"},on:{click:function(e){t.handlerAdd()}}},[t._v("添加栏目")])],1),t._v(" "),i("tree-table",{attrs:{data:t.data,columns:t.columns,expandAll:"",border:""}},[i("el-table-column",{attrs:{width:"400px",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){var a=e.row;return[i("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"增加子栏目",placement:"top"}},[i("el-button",{attrs:{size:"small",icon:"el-icon-plus"},on:{click:function(e){t.handlerAdd(a)}}})],1),t._v(" "),i("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){t.handleUpdate(a)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){t.handlerDelete(a)}}},[t._v("删除")])]}}])})],1),t._v(" "),i("add",{ref:"dialog",on:{success:t.success}})],1)},staticRenderFns:[]};var d=i("VU/8")(u,m,!1,function(t){i("SJZK")},null,null);e.default=d.exports},Afq5:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"\n.image[data-v-8869537e] {\n  max-width: 80%;\n  max-height: 100%;\n  display: block;\n  margin: 10px auto 0;\n}\n",""])},SJZK:function(t,e,i){var a=i("prJA");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("0426420a",a,!0)},"k1Y/":function(t,e,i){var a=i("Afq5");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);i("rjj0")("144a878a",a,!0)},prJA:function(t,e,i){(t.exports=i("FZ+f")(!1)).push([t.i,"",""])}});