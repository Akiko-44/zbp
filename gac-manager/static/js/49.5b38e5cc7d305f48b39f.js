webpackJsonp([49],{"/2IF":function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),i=r.n(a),n=r("//Fk"),o=r.n(n),s=r("d7EF"),l=r.n(s),c=r("exGp"),d=r.n(c),u=r("lXeh"),f=r("cAgV"),m=r("TAej"),g=r("BBBQ"),p=r("5aCZ"),h={name:"editDocument",directives:{waves:f.a},data:function(){return{loading:!1,categories:[],selectedCategory:[],form:{id:void 0,artTitle:"",articleType:void 0,articleDesc:"",categoryFid:void 0,categoryZid:void 0},rules:{artTitle:[{required:!0,message:"请输入标题",trigger:"blur"},{min:2,max:60,message:"长度在 2 到 60 个字符",trigger:"blur"}],categoryZid:[{required:!0,message:"请选择栏目",trigger:"blur"}],articleDesc:[{required:!0,message:"请填写正文内容",trigger:"blur"}]},editStatus:!0}},beforeRouteLeave:function(e,t,r){this.onbeforeunloadHandler(r)},beforeRouteEnter:function(e,t,r){var a=this;return d()(i.a.mark(function t(){var n,s,c,d,f;return i.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return n=[g.a.get()],e.query.id&&n.push(Object(u.b)(e.query.id).then(function(e){return e.data})),t.next=4,o.a.all(n);case 4:s=t.sent,c=l()(s,2),d=c[0],f=c[1],r(function(e){setTimeout(function(){e.categories=d,f&&(delete f.propIds,delete f.props,delete f.columns,e.form=f,e.selectedCategory=g.a.getParentId(e.form.categoryZid))},10)});case 9:case"end":return t.stop()}},t,a)}))()},methods:{save:function(e){var t=this;0===e?this.form.articleType=0:1===e&&(this.form.articleType=1),this.$refs.form.validate(function(e){if(!e)return t.$notify({title:"警告",message:"请务必填写必选项",type:"warning"}),!1;t.loading=!0,Object(u.d)(t.form).then(function(e){t.editStatus=!1,t.$notify({title:"成功",message:"提交成功",type:"success",duration:2e3}),t.$router.push({name:"index"}),t.loading=!1}).catch(function(){t.loading=!1})})},reset:function(){this.$refs.form.resetFields()},uploadSuccess:function(e){this.form.thumbnail=e[e.length-1].key},onbeforeunloadHandler:function(e){this.editStatus?window.confirm("确定要放弃当前的操作吗？")?e():e(!1):e()},handleCategoryChange:function(e){this.form.categoryFid=e[0],this.form.categoryZid=e[1]}},components:{ImageUpload:m.a,Tinymce:p.a}},y={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container",staticStyle:{"padding-right":"40px"}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"标题",prop:"artTitle"}},[r("el-input",{attrs:{placeholder:"请输入标题"},model:{value:e.form.artTitle,callback:function(t){e.$set(e.form,"artTitle",t)},expression:"form.artTitle"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"分类",prop:"categoryZid"}},[r("el-cascader",{attrs:{options:e.categories,props:{value:"id",label:"name"}},on:{change:e.handleCategoryChange},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"正文内容",prop:"articleDesc"}},[r("Tinymce",{ref:"editor",attrs:{height:500},model:{value:e.form.articleDesc,callback:function(t){e.$set(e.form,"articleDesc",t)},expression:"form.articleDesc"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){e.save(0)}}},[e._v("保存草稿")]),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){e.save(1)}}},[e._v("保存并发布")])],1)],1)],1)},staticRenderFns:[]};var v=r("VU/8")(h,y,!1,function(e){r("VJ7E")},"data-v-fc44f142",null);t.default=v.exports},VJ7E:function(e,t,r){var a=r("bdKq");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("rjj0")("7665d6cd",a,!0)},bdKq:function(e,t,r){(e.exports=r("FZ+f")(!1)).push([e.i,"\n.image[data-v-fc44f142] {\n    max-width: 80%;\n    max-height: 100%;\n    display: block;\n    margin: 10px auto 0;\n}\n",""])}});