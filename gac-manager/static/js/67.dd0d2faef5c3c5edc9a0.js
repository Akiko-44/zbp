webpackJsonp([67],{BBe9:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("Xxa5"),o=r.n(a),s=r("//Fk"),i=r.n(s),n=r("d7EF"),l=r.n(n),c=r("exGp"),d=r.n(c),m=r("fZjL"),u=r.n(m),p=r("cAgV"),g=r("TAej"),f=r("5aCZ"),h=r("OYva"),v=r("kFM0"),b=r("C0nA"),k=r("IcnI"),y=r("oyZn"),x=r("Q0Ca"),_={directives:{waves:p.a},computed:{brands:function(){return this.$store.state.data.swapBrands},deprecitionStatus:function(){return u()(y.d).map(function(e){return{value:e,label:y.d[e]}})}},watch:{dateValue:function(e){this.form.auctionStartTime=e?e[0]:void 0,this.form.auctionEndTime=e?e[1]:void 0}},data:function(){return{rules:{goodsName:[{required:!0,message:"请输入商品名称",trigger:"blur"},{min:2,max:20,message:"长度在 2 到 20 个字符",trigger:"blur"}],categoryId:[{required:!0,message:"请选择商品分类",trigger:"blur"}],brandId:[{required:!0,message:"请选择商品品牌",trigger:"blur"}],deprecition:[{required:!0,message:"请选择新旧程度",trigger:"blur"}],upsetPrice:[{required:!0,message:"请输入起拍价",trigger:"blur"}],skipPrice:[{required:!0,message:"请输入最小加价",trigger:"blur"}],reservePrice:[{required:!0,message:"请输入保留价",trigger:"blur"}],deposit:[{required:!0,message:"请输入保证金",trigger:"blur"}],imgs:[{required:!0,message:"请上传商品图片",trigger:"blur"}],auctionEndTime:[{required:!0,message:"请选择竞拍起止时间",trigger:"blur"}],"hsMark.hsMarkName":[{required:!0,message:"请输入鉴定机构",trigger:"blur"}],"hsMark.hsMarkUrl":[{required:!0,message:"请上传鉴定证书",trigger:"blur"}],goodsDesc:[{required:!0,message:"请填写商品描述",trigger:"blur"}]},categories:[],selectedCategory:[],loading:!1,form:{id:void 0,categoryId:void 0,goodsName:void 0,brandId:void 0,deprecition:void 0,upsetPrice:void 0,skipPrice:void 0,reservePrice:void 0,deposit:void 0,imgs:[],hsMark:{hsMarkUrl:"",hsMarkName:"default"},goodsDesc:""},editStatus:!0,dateValue:"",pickerOptions:{}}},beforeRouteEnter:function(e,t,r){var a=this;return d()(o.a.mark(function t(){var s,n,c,d,m,u;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return s=[k.a.dispatch("data/get",{name:"swapBrands",service:h.a}),y.c.get()],e.query.id&&(s.push(Object(b.d)(e.query.id).then(function(e){return e.data})),s.push(Object(v.c)(e.query.id).then(function(e){return e.data?e.data.goodsDesc:""}))),t.next=4,i.a.all(s);case 4:n=t.sent,c=l()(n,4),d=c[1],m=c[2],u=c[3],r(function(e){setTimeout(function(){e.categories=d,m&&(e.form=m,e.form.goodsDesc=u,e.selectedCategory=y.c.getParentId(e.form.categoryId),e.dateValue=[e.form.auctionStartTime,e.form.auctionEndTime])},10)});case 10:case"end":return t.stop()}},t,a)}))()},beforeRouteLeave:function(e,t,r){this.onbeforeunloadHandler(r)},methods:{onbeforeunloadHandler:function(e){this.editStatus?window.confirm("确定要放弃当前的操作吗？")?e():e(!1):e()},handleDelete:function(e){this.form.imgs.splice(e,1)},getImageStyle:function(e){return{backgroundImage:"url("+Object(x.setImg)(e.imgUrl,{w:500})+")"}},goodsUploadSuccess:function(e){var t=this;e.forEach(function(e){t.form.imgs.push({imgUrl:e.key,imgType:2})}),1===this.form.imgs.length&&(this.form.imgs[0].imgType=1)},cerUploadSuccess:function(e){this.form.hsMark.hsMarkUrl=e[0].key},save:function(){var e=this;this.$refs.form.validate(function(t){if(!t)return e.$notify({title:"警告",message:"请务必填写必选项",type:"warning"}),!1;e.loading=!0,e.form.swapble=+e.form.swapble,Object(b.g)(e.form).then(function(t){e.editStatus=!1,e.$notify({title:"成功",message:"提交成功",type:"success",duration:2e3}),e.$router.push({name:"auctionInfo"}),e.loading=!1}).catch(function(){e.loading=!1})})},setCover:function(e){var t=this;return d()(o.a.mark(function r(){return o.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:t.form.imgs.forEach(function(e){1===e.imgType&&(e.imgType=2)}),e.imgType=1;case 2:case"end":return r.stop()}},r,t)}))()},handleChange:function(e){this.form.categoryId=e[e.length-1]}},components:{ImageUpload:g.a,Tinymce:f.a}},w={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"app-container",staticStyle:{"padding-right":"40px"}},[r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"商品名称",prop:"goodsName"}},[r("el-input",{attrs:{placeholder:"请输入商品名称"},model:{value:e.form.goodsName,callback:function(t){e.$set(e.form,"goodsName",t)},expression:"form.goodsName"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品分类",prop:"categoryId"}},[r("el-cascader",{attrs:{options:e.categories,props:{value:"id",label:"catName"}},on:{change:e.handleChange},model:{value:e.selectedCategory,callback:function(t){e.selectedCategory=t},expression:"selectedCategory"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品品牌",prop:"brandId"}},[r("el-select",{attrs:{placeholder:"商品品牌"},model:{value:e.form.brandId,callback:function(t){e.$set(e.form,"brandId",t)},expression:"form.brandId"}},e._l(e.brands,function(e){return r("el-option",{key:e.id,attrs:{label:e.brandName,value:e.id}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"新旧程度",prop:"deprecition"}},[r("el-select",{attrs:{placeholder:"新旧程度"},model:{value:e.form.deprecition,callback:function(t){e.$set(e.form,"deprecition",t)},expression:"form.deprecition"}},e._l(e.deprecitionStatus,function(e){return r("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),r("el-form-item",{attrs:{label:"起拍价",prop:"upsetPrice"}},[r("el-input",{attrs:{type:"number",maxlength:"10",placeholder:"请输入起拍价"},model:{value:e.form.upsetPrice,callback:function(t){e.$set(e.form,"upsetPrice",e._n(t))},expression:"form.upsetPrice"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"最小加价",prop:"skipPrice"}},[r("el-input",{attrs:{type:"number",maxlength:"10",placeholder:"买家每次出价的最小加价幅度"},model:{value:e.form.skipPrice,callback:function(t){e.$set(e.form,"skipPrice",e._n(t))},expression:"form.skipPrice"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"保留价",prop:"reservePrice"}},[r("el-input",{attrs:{type:"number",maxlength:"10",placeholder:"请输入保留价"},model:{value:e.form.reservePrice,callback:function(t){e.$set(e.form,"reservePrice",e._n(t))},expression:"form.reservePrice"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"保证金",prop:"deposit"}},[r("el-input",{attrs:{type:"number",maxlength:"10",placeholder:"买家竞拍需事先交纳的款项，保证金不可高于保留价"},model:{value:e.form.deposit,callback:function(t){e.$set(e.form,"deposit",e._n(t))},expression:"form.deposit"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"竞拍时间",prop:"auctionEndTime"}},[r("el-date-picker",{attrs:{"value-format":"yyyy-MM-dd HH:mm:ss",type:"datetimerange","picker-options":e.pickerOptions,"range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期",align:"right"},model:{value:e.dateValue,callback:function(t){e.dateValue=t},expression:"dateValue"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品图片",prop:"imgs"}},[r("el-row",{directives:[{name:"show",rawName:"v-show",value:e.form.imgs.length,expression:"form.imgs.length"}],staticClass:"row"},e._l(e.form.imgs,function(t,a){return r("el-col",{key:a,staticClass:"col",attrs:{span:6}},[r("el-card",{attrs:{"body-style":{padding:"0px"}}},[r("a",{staticClass:"image",style:e.getImageStyle(t),attrs:{target:"_blank",href:e._f("setImg")(t.imgUrl)}}),e._v(" "),r("div",{staticStyle:{padding:"14px"}},[r("div",{staticClass:"bottom clearfix"},[1===t.imgType?r("el-tag",[e._v("封面")]):r("el-button",{attrs:{type:"text"},on:{click:function(r){e.setCover(t)}}},[e._v("设为封面")]),e._v(" "),r("el-button",{attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(t){e.handleDelete(a)}}})],1)])])],1)})),e._v(" "),r("ImageUpload",{attrs:{multiple:!0,prefix:"swap"},on:{successCBK:e.goodsUploadSuccess}})],1),e._v(" "),r("el-form-item",{attrs:{label:"鉴定证书",prop:"hsMark.hsMarkUrl"}},[e.form.hsMark.hsMarkUrl?r("el-card",{staticStyle:{width:"250px"},attrs:{"body-style":{padding:"0px"}}},[r("img",{attrs:{src:e._f("setImg")(e.form.hsMark.hsMarkUrl),width:"100%"}}),e._v(" "),r("div",{staticStyle:{padding:"14px"}},[r("div",{staticClass:"bottom clearfix"},[r("el-button",{staticClass:"button",attrs:{type:"text"},on:{click:function(t){e.form.hsMark.hsMarkUrl=""}}},[e._v("删除")])],1)])]):e._e(),e._v(" "),r("ImageUpload",{directives:[{name:"show",rawName:"v-show",value:!e.form.hsMark.hsMarkUrl,expression:"!form.hsMark.hsMarkUrl"}],attrs:{multiple:!1,prefix:"swap"},on:{successCBK:e.cerUploadSuccess}})],1),e._v(" "),r("el-form-item",{attrs:{label:"商品描述",prop:"goodsDesc"}},[r("Tinymce",{ref:"editor",attrs:{height:500},model:{value:e.form.goodsDesc,callback:function(t){e.$set(e.form,"goodsDesc",t)},expression:"form.goodsDesc"}})],1),e._v(" "),r("el-form-item",[r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:e.save}},[e._v("保存")])],1)],1)],1)},staticRenderFns:[]};var M=r("VU/8")(_,w,!1,function(e){r("WXhC")},"data-v-51c327f2",null);t.default=M.exports},Ddum:function(e,t,r){(e.exports=r("FZ+f")(!1)).push([e.i,"\n.image[data-v-51c327f2]{\n  display: block;\n  max-width: 100%;\n  padding-bottom: 100%;\n  height: 0;\n  background-size: cover;\n  background-repeat: no-repeat;\n  background-position: center;\n}\n.row[data-v-51c327f2] {\n  position: relative;\n  left: -20px;\n  margin-top: 10px;\n}\n.col[data-v-51c327f2] {\n  margin-bottom: 20px;\n  margin-left: 20px;\n  max-width: 22.8%;\n  max-height: 400px;\n}\n",""])},WXhC:function(e,t,r){var a=r("Ddum");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);r("rjj0")("2615e3e4",a,!0)}});